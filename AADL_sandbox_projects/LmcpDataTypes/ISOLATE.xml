<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE MDM SYSTEM 'MDM.DTD'>

<!--
        <h2>Introduction</h2>
        Message definitions for the VICS scenario
-->
<MDM>
    <SeriesName>ISOLATE</SeriesName>
    <Namespace>uxas/project/isolate</Namespace>
    <Version>2</Version>

	<EnumList>
	
        <!-- Lists the states of the road monitoring mission. -->
        <Enum Name="State">
            <Entry Name="NoState" Value="0"/>
            <Entry Name="Unknown" Value="1"/>
            <Entry Name="Patrol" Value="2"/>
            <Entry Name="Isolate" Value="3"/>
            <Entry Name="Capture" Value="4"/>
            <Entry Name="Deliver" Value="5"/>
            <Entry Name="Response" Value="6"/>
        </Enum>
		
		<!-- Detected type of intruder -->
        <Enum Name="IntruderType">
            <Entry Name="NoDetection" Value="0"/> <!-- historical only, use sub class for green -->
            <Entry Name="Unknown" Value="1"/>
            <Entry Name="UGSDetect" Value="2"/>
            <Entry Name="Dismount" Value="3"/>
            <Entry Name="FourWheeledVehicle" Value="4"/>
            <Entry Name="TreadedVehicle" Value="5"/>
        </Enum>
		
		<!-- Isolation controller reasons for termination -->
		<Enum Name="IsolationTerminationReason">
			<Entry Name="FalseAlarm" Value="0" />
			<Entry Name="IntruderEscape" Value="1" />
			<Entry Name="IntruderCapture" Value="2" />
		</Enum>
		
	</EnumList>
	
    <StructList>

		<!-- Patrol task for establishing constant circuit visit to a set of locations -->
		<Struct Name="PatrolTask" Extends="CMASI/Task" >
			<!-- Location of positions to visit on patrol -->
			<Field Name="VisitLocations" Type="UXCOMM/CommTransferTask[]" />
		</Struct>
        
		<!-- Persistent super-task for managing sub-tasks related to patrol, isolation, capture and delivery.
        This task should be requested from the control station as the only task to be completed after submitting
        the applicable keep-in and keep-out zones. The AutomationRequest message that initiates the start of this
        task is preserved for all subsequent sub-tasks that are generated by this task (i.e. altitude and speed
        constraints set by the AutomationRequest and applicable zones are used to compute the parameters in the
        relevant sub-tasks). -->
		<Struct Name="UgsManagementTask" Extends="CMASI/Task" >
			<!-- Road network and UGS locations -->
            <Field Name="UgsPlacement" Type="UgsLaydown" />
            <!-- Intended UAVs to complete this UGS Management Task -->
            <Field Name="UavID" Type="int64[]" />
            <!-- Operating region ID to be considered during planning -->
            <Field Name="OperatingRegion" Type="int64"/>
		</Struct>
	
		<!-- Represents a state change during the patrol mission. During the Isolate state,
        a state transition of re-directing to a new UGS for investigation should also be
        reported as a state transition (e.g. Isolate going to UGS3, then Isolate going to UGS7). -->
		<Struct Name="StateTransition" Extends="VICS/VicsBase">
			<!-- The State that the transition event is going to.  -->
			<Field Name="State" Type="State" />
			 <!-- Brief description of payload data included -->
            <Field Name="PayloadDescription" Type="string" />
			 <!-- Data associated with the state transition -->
            <Field Name="Payload" Type="VICS/PayloadData" />
			<!-- The ID of the Unattended Ground Sensor it is traveling to, or 0 if destination is not an UGS. -->
			<Field Name="UgsID" Type="int64" />
		</Struct>

		<!-- Occurs when a UGS detects an object, aka red alert. -->
		<Struct Name="IntruderAlert" Extends="VICS/IntruderAlertBase">
			<!-- The location at which the object was detected.  -->
			<Field Name="DetectionLocation" Type="CMASI/Location3D" />
			<!-- Optional UGS ID of unit that detected the intruder. A value of 0 indicates no UGS performed the detection. -->
			<Field Name="UgsID" Type="int64" />
			<!-- Type of intruder detected. If NoDetection, no need for specifying intruder speed and direction -->
			<Field Name="Intruder" Type="IntruderType" />
			<!-- The speed at which the detected object is going.  -->
			<Field Name="ObjectSpeed" Type="real32" Units="meter/sec" /> 
			<!-- The direction in which the detected object is moving referenced from true north.  -->
			<Field Name="ObjectDirection" Type="real32" Units="degrees" />
			<!-- Brief description of payload data included -->
			<Field Name="PayloadDescription" Type="string" />
			<!-- This is the actual payload data.  Each payload stored in row by row format.  -->
			<Field Name="Payload" Type="VICS/PayloadData" />
		</Struct>

		<!-- When no measurements were made, this indicates the absence of measurements (aka green alert) -->
		<Struct Name="GreenIntruderAlert" Extends="VICS/IntruderAlertBase">
			<!-- The location at which the absence of measurements is reported -->
			<Field Name="DetectionLocation" Type="CMASI/Location3D" />
			<!-- Optional UGS ID of unit that is reporting an absence of measurements -->
			<Field Name="UgsID" Type="int64" />
			<!-- Brief description of payload data included -->
			<Field Name="PayloadDescription" Type="string" />
			<!-- This is the actual payload data.  Each payload stored in row by row format.  -->
			<Field Name="Payload" Type="VICS/PayloadData" />
		</Struct>
      
        <!-- Definition of fixed UGS on a road network -->
        <Struct Name="FixedUGS" >
            <!-- UGS ID-->
            <Field Name="UgsID" Type="int64" />
            <!-- Location in real world coordinates -->
            <Field Name="UgsLocation" Type="CMASI/Location3D" />
            <!-- Location relative to network -->
            <Field Name="UgsNetworkLocation" Type="ESTIMATE/NetworkLocation" />
        </Struct>
      
        <!-- Combined road nework and fixed UGS locations -->
        <Struct Name="UgsLaydown" >
            <!-- Network on which all UGS lay -->
            <Field Name="RoadNetwork" Type="ESTIMATE/NetworkRegion" />
            <!-- List of all UGS fixed to this road network -->
            <Field Name="UgsList" Type="FixedUGS[]" />
            <!-- Location in real world coordinates of delivery location (VICS Central) -->
            <Field Name="DeliveryLocation" Type="CMASI/Location3D" />
        </Struct>
      
        <!-- Isolation controller initialization. Currently applied only to
        a single intruder with lower bounded speed -->
        <Struct Name="IsolationControllerInitialization" >
            <!-- Road network and UGS locations -->
            <Field Name="UgsPlacement" Type="UgsLaydown" />
            <!-- Lower bound on intruder speed -->
            <Field Name="IntruderSpeed" Type="real32" Units="m/s" />
        </Struct>
        
        <!-- Command the UAV(s) to fly immediately to a set of fixed UGS locations with associated wait times. If only a single vehicle involved, then the first on the list is to be visited. For multiple vehicles, an assignment is performed to assign the top tasks to each of the vehicles. -->
        <Struct Name="VisitUgsAndWaitCommand" >
            <!-- UGS Priority list -->
            <Field Name="UgsPriorityList" Type="UgsTimePair[]" />
        </Struct>
        
        <!-- Ugs/Time pair -->
        <Struct Name="UgsTimePair" >
            <!-- UGS ID -->
            <Field Name="UgsID" Type="int64" />
            <!-- Absolute time after which intruder has passed corresponding UgsID -->
            <Field Name="UgsTime" Type="int64" Units="milliseconds since 1 Jan 1970" />
        </Struct>
      
        <!-- Isolation controller has determined that there has been a false
        alarm or intruder cannot be captured -->
        <Struct Name="IsolationControllerTerminated" >
            <!-- Reason for exiting isolation mode -->
            <Field Name="Reason" Type="IsolationTerminationReason" />
        </Struct>
        
        <!-- Isolation Coordination -->
        <Struct Name="IsolationCoordination" >
            <!-- ID of the entity that sent this message -->
            <Field Name="SenderID" Type="int64" />
            <!-- Current alert state, i.e. mode of the UAV -->
            <Field Name="VehicleMode" Type="State" Default="NoState"/>
            <!-- Waiting for intruder, i.e. loitering about an UGS -->
            <Field Name="WaitingForIntruder" Type="bool" />
            <!-- Latest Red Alert received -->
            <Field Name="LatestRedAlert" Type="IntruderAlert" />
            <!-- Cleared child nodes -->
            <Field Name="ClearedNodes" Type="int64[]" />
            <!-- EntityStates, from self/teammates, for coordination -->
            <Field Name="TeamStates" Type="CMASI/EntityState[]" />
        </Struct>
        
        <!-- Alert summary from each entity -->
        <Struct Name="EntityAlertSummary" >
            <!-- Entity ID -->
            <Field Name="EntityID" Type="int64" />
            <!-- Latest report reported from this entity -->
            <Field Name="LastAlert" Type="VICS/IntruderAlertBase" Default="null" Optional="true" />
            <!-- Total number of red alerts reported from this entity -->
            <Field Name="TotalAlerts" Type="uint32" Default="0" />
        </Struct>
        
        <!-- Isolation Summary -->
        <Struct Name="IsolationSummary" >
            <!-- ID of the entity that sent this message -->
            <Field Name="SenderID" Type="int64" />
            <!-- Location of entity -->
            <Field Name="SenderLocation" Type="CMASI/Location3D" />
            <!-- Speed of entity -->
            <Field Name="SenderSpeed" Type="real32" Units="m/s" />
            <!-- Heading of entity from true North -->
            <Field Name="SenderHeading" Type="real32" Units="degrees" />
            <!-- Entity has valid state -->
            <Field Name="ValidState" Type="bool" Default="false" />
            <!-- Entity is authorized to act -->
            <Field Name="ValidAuthorization" Type="bool" Default="false" />
            <!-- Summary of entities in communication (from join/exit message traffic) -->
            <Field Name="ConnectedEntities" Type="EntityAlertSummary[]" />
            <!-- Current alert state, i.e. mode of the UAV -->
            <Field Name="VehicleMode" Type="State" Default="NoState"/>
            <!-- Latest Alert received -->
            <Field Name="LatestRedAlert" Type="IntruderAlert" Default="null" Optional="true" />
            <!-- Next UGS to visit during isolation -->
            <Field Name="NextUgs" Type="int64" Default="0" />
            <!-- Duration of loiter at next UGS when in isolate -->
            <Field Name="LoiterDuration" Type="int64" Default="0" Units="milliseconds" />
            <!-- Current time as reported by aircraft -->
            <Field Name="CurrentTime" Type="int64" Default="0" Units="milliseconds" />
            <!-- Current task being carried out -->
            <Field Name="CurrentTask" Type="int64" Default="0" />
            <!-- Next task to be carried out -->
            <Field Name="NextTask" Type="int64" Default="0" />
        </Struct>
	  
 </StructList>
</MDM>
